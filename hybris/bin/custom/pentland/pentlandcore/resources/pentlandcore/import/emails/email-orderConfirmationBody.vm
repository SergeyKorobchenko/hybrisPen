## messageSource=classpath:/pentlandcore/messages/email-orderConfirmation_$lang.properties
#macro( genHtmlBoldFont $text )
<font color="#414a4f" size="2" face="Arial, Helvetica, sans-serif"><b>$text</b></font>
#end
#macro(genHtmlLinkStartTag $url)
<a href="$url"><font color="#0468b3">
#end
#macro(genHtmlLinkEndTag)
</font></a>
#end
#macro(genHtmlLink $url $textColor $bodyContent)
<a href="$url"><font color="$textColor">$bodyContent</font></a>
#end
<html>

<head>
  <style>
    a {
      color: #0468b3;
    }
  </style>
</head>

<body>
	#set ($ordersUrl = "${ctx.secureBaseUrl}/my-account/orders/")
<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" style="font-size:16px;background:#f4f4f4;">
  <tr>
    <td valign="middle">
			${ctx.cmsSlotContents.SiteLogo}
    </td>
  </tr>
  <tr>
    <td align="center" valign="top" style="background-color: #ffffff;padding-top:20px;padding-bottom:20px;padding-left:20px;padding-right:20px;">
      <table width="570" align="center" border="0" cellspacing="0" cellpadding="0">
        <tr>
          <td align="center" valign="top" bgcolor="#FFFFFF">
            <table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" style="boarder-collapse;">
              <tr>
                <td valign="middle"></td>
              </tr>
              <tr>
              </tr>
              <tr>
                <td>
                  <hr/>
                </td>
              </tr>
							#if (${ctx.cmsSlotContents.TopContent})
                <tr>
                  <td align="center" valign="middle">
                    <a href="${ctx.baseUrl}" style="display:block; margin-top:10px;margin-bottom:10px;font-family:arial,helvetica,sans-serif; font-size: 14px;color:#19212b;text-decoration: none;">${ctx.cmsSlotContents.TopContent}</a>
                  </td>
                </tr>
							#end
              <tr>
                <td align="left" valign="top">

                  <p style="margin:2px 0"><font color="#000000" size="2" face="Arial, Helvetica, sans-serif"><b>${ctx.messages.getMessage('salutation', ${ctx.title}, ${ctx.displayName})}</b>,</font></p>
                  <br />

                  <p style="margin:2px 0"><font color="#000000" size="2" face="Arial, Helvetica, sans-serif">${ctx.messages.getMessage('thankYouParagraph')}</font></p>
                  <br />

                  <p style="margin:2px 0"><font color="#000000" size="2" face="Arial, Helvetica, sans-serif">${ctx.messages.getMessage('summaryBelowParagraph', "#genHtmlLinkStartTag($orderInfoUrl)", "#genHtmlBoldFont(${ctx.messages.hereLink})", "#genHtmlLinkEndTag()")}</font></p>
                </td>
              </tr>
              <br/>
              <br/>
              <table align="center" border="1" cellspacing="0" cellpadding="15"> 
              <tr>
               <th>OrderCode</th>
               <th>PONumber</th>
               <th>OrderStatus</th>
               <th>Brand</th>
               <th>DateOfPlaced</th>
               <th>orderRdd</th>
               <th>TotalPrice</th>
               <th>Quantity</th>
             </tr>
				#foreach ($order in $ctx.order.subOrders)
                <tr>
                  <td>
                    <div><strong>${ctx.order.code}</strong></div></td>
                    <td><div>${ctx.order.purchaseOrderNumber}
                    </div></td>
                    <td><div style="display: block;font-family:arial,helvetica,sans-serif;font-size: 14px;padding-bottom:5px;">${ctx.order.statusDisplay}
                </div></td>
                    #if (!$order.orderType)
                      #set($order.orderType = "")
                    #end
                    #if (!$order.brand)
                      #set($order.brand = "")
                    #end
                   <td> 
                   <div>$order.brand
                                 </div></td>
                   <td> <div style="display: block;font-family:arial,helvetica,sans-serif;font-size: 14px;padding-bottom:5px;">${ctx.dateTool.format('d MMM, yyyy', $order.created)}
                  						</div></td>
                  <td>  <div style="display: block;font-family:arial,helvetica,sans-serif;font-size: 14px;padding-bottom:5px;">${ctx.dateTool.format('d MMM, yyyy', $order.rdd)}
                  					</div></td>
                 <td>   <div style="display: block;font-family:arial,helvetica,sans-serif;font-size: 14px;padding-bottom:5px;">${ctx.order.totalPrice.formattedValue}
                                        </div></td>
                 <td>   <div style="display: block;font-family:arial,helvetica,sans-serif;font-size: 14px;padding-bottom:5px;">${ctx.order.totalUnitCount}
                                        </div></td>
                </tr>
					#end
					</table>
		<br/><br/>
		<strong>${ctx.messages.deliveryItems}</strong><br/>
	<br/>
		  #if ($ctx.order.deliveryOrderGroups.size() > 0)
	<table width="100%" border="0" align="center" cellpadding="2" cellspacing="2" bordercolor="#51585c" class="products" style="border: 1px solid #51585c;">
		<tr>
			<td>
				#foreach( $orderGroup in ${ctx.order.deliveryOrderGroups} )
					<table width="100%" cellpadding="0" cellspacing="0">
						<tr>
							<td width="100%" colspan="4" height="30" align="left" bgcolor="#000000"><font color="#FFFFFF" size="2" face="Arial, Helvetica, sans-serif" style="padding-left:5px"><b style="text-transform:uppercase;">${ctx.messages.yourDeliveryItems}</b></font></td>
						</tr>
						<tr>
							<td width="50%"><font color="#333" size="2" face="Arial, Helvetica, sans-serif"><b>&nbsp;</b></font></td>
							<td width="17%" height="40px"><font color="#333" size="2" face="Arial, Helvetica, sans-serif"><b>${ctx.messages.quantity}</b></font></td>
							<td width="17%" height="40px"><font color="#333" size="2" face="Arial, Helvetica, sans-serif"><b>${ctx.messages.itemPrice}</b></font></td>
							<td width="16%" height="40px"><font color="#333" size="2" face="Arial, Helvetica, sans-serif"><b>${ctx.messages.total}</b></font></td>
						</tr>
						#foreach( $entry in ${orderGroup.entries} )
							<tr>
								<td>
									<table width="100%" border="0" cellpadding="0" cellspacing="0">
										<tr>
											<td valign="top" width="110px" style="width:110px;padding-left:10px;padding-right:10px">
												<a href="${ctx.baseUrl}$entry.product.url" style="text-decoration:none">
													#foreach($image in $entry.product.images) #if($image.imageType == "PRIMARY" && $image.format == "thumbnail" )
														<img src="${ctx.mediaBaseUrl}$image.url" alt="" title="$entry.product.name"/>
													#end #end
												</a>
												&nbsp;
											</td>
											<td valign="top">
												<p><font color="#666666" size="2" face="Arial, Helvetica, sans-serif">
													<a href="${ctx.baseUrl}$entry.product.url"><font color="#666666"><b>$entry.product.name</b></font></a>
												</p>
												
												#if (!$entry.product.baseOptions.isEmpty())
													#foreach ($option in $entry.product.baseOptions)
														#if (!$option.selected.isEmpty && ($option.selected.url == $entry.product.url))
															<table width="100%" cellpadding="0" cellspacing="0">
																#foreach ($selectedOption in $option.selected.variantOptionQualifiers)
																	<tr>
																		<td width="30%" valign="top"><p><font color="#666666" size="2" face="Arial, Helvetica, sans-serif">$selectedOption.name:</font></p></td>
																		<td width="70%" valign="top"><p><font color="#666666" size="2" face="Arial, Helvetica, sans-serif">$selectedOption.value</font></p></td>
																	</tr>
																#end
															</table>
														#end
													#end
												#end
												#if (!$ctx.order.appliedProductPromotions.isEmpty())
													#foreach( $promotion in $ctx.order.appliedProductPromotions)
														#set ($displayed = false)
														#foreach ($consumedEntry in $promotion.consumedEntries)
															#if (!$displayed && ($consumedEntry.orderEntryNumber == $entry.entryNumber))
																#set ($displayed = true)
																<p><font color="#414a4f" size="2" face="Arial, Helvetica, sans-serif"><b>${promotion.description}</b></font></p>
															#end
														#end
													#end
												#end
											</td>
										</tr>
									</table>
								</td>
								<td valign="top"><p><font color="#666666" size="2" face="Arial, Helvetica, sans-serif">$entry.quantity</font></p></td>
								<td valign="top"><p><font color="#666666" size="2" face="Arial, Helvetica, sans-serif">$entry.erpPrice.formattedValue</font></p></td>
								#set ($total = $entry.erpPrice.value * $entry.quantity)
								<td valign="top"><p><font color="#414a4f" size="3" face="Arial, Helvetica, sans-serif"><b>Â£$total</b></font></p></td>
							</tr>
						#end
					</table>
				#end
			</td>
		</tr>
	</table>
	#end 
					
			<br/>
			<br/>		
							
              <tr>
                <td>
                  #set ($contactLink = $ctx.secureBaseUrl + $ctx.messages.contactUsPage)
                  <p style="margin:2px 0"><font color="#000000" size="2" face="Arial, Helvetica, sans-serif">${ctx.messages.getMessage('contactUsParagraph', "#genHtmlLinkStartTag($contactLink)", "#genHtmlBoldFont(${ctx.messages.contactUs})", "#genHtmlLinkEndTag()")}</font></p>
                  <p>
                    <font color="#000000" size="2" face="Arial, Helvetica, sans-serif">
											${ctx.messages.complimentaryClosing}
                      <br />
											${ctx.messages.companyName}
                    </font>
                  </p>
                  <br />
                </td>
              </tr>
							#if (${ctx.cmsSlotContents.BottomContent})
                <tr>
                  <td align="center" valign="middle">
                    <a href="${ctx.baseUrl}" style="display:block; margin-top:10px;margin-bottom:10px;">${ctx.cmsSlotContents.BottomContent}</a>
                  </td>
                </tr>
              #else
                <hr/>
							#end
              <tr>
								#if ($ctx.salesRep)
                  <td>
                    <div style="display: block;font-family:arial,helvetica,sans-serif;font-size: 14px;padding-bottom:5px;"><strong>$ctx.messages.internalUse</strong></div>
                    <div style="display: block;font-family:arial,helvetica,sans-serif;font-size: 14px;padding-bottom:5px;">$ctx.messages.getMessage('internalCustomerName',$ctx.customer.name)</div>
                    <div style="display: block;font-family:arial,helvetica,sans-serif;font-size: 14px;padding-bottom:5px;">$ctx.messages.getMessage('internalCustomerEmail',$ctx.customer.uid)</div>
                    <div style="display: block;font-family:arial,helvetica,sans-serif;font-size: 14px;padding-bottom:5px;">$ctx.messages.getMessage('internalCustomerSoldTo',$ctx.account)</div>
                  </td>
								#end
              </tr>
            </table>
          </td>
        </tr>
      </table>
    </td>
  </tr>
  <tr>
    <td bgcolor="#F4F4F4" style="padding-top:26px;padding-bottom:50px;padding-right:35px;padding-left:40px;">
      <table style="width: 100%; height: 30px; border-collapse:collapse;" cellpadding="0">
        <tbody>
        <tr>
          <td align="center" style="font-size: 14px;">
						${ctx.messages.companyFullName}
            <br/> ${ctx.messages.companyAddress}
            <br/> ${ctx.secureBaseUrl}
          </td>
        </tr>
        </tbody>
      </table>
    </td>
  </tr>
  <tr>
    <td> </td>
  </tr>
</table>
</body>

</html>

