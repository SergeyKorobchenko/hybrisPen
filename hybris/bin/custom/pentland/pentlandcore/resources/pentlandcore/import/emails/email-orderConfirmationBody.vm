## messageSource=classpath:/pentlandcore/messages/email-orderConfirmation_$lang.properties
#macro( genHtmlBoldFont $text )
<font color="#414a4f" size="2" face="Arial, Helvetica, sans-serif"><b>$text</b></font>
#end
#macro(genHtmlLinkStartTag $url)
<a href="$url"><font color="#0468b3">
#end
#macro(genHtmlLinkEndTag)
</font></a>
#end
#macro(genHtmlLink $url $textColor $bodyContent)
<a href="$url"><font color="$textColor">$bodyContent</font></a>
#end
<html>

<head>
  <style>
    a {
      color: #0468b3;
    }
  </style>
</head>

<body>
	#set ($ordersUrl = "${ctx.secureBaseUrl}/my-account/orders/")
<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" style="font-size:12px;background:#f4f4f4;">
  <tr>
    <td valign="middle">
			${ctx.cmsSlotContents.SiteLogo}
    </td>
  </tr>
  <tr>
    <td align="center" valign="top" style="background-color: #ffffff;padding-top:20px;padding-bottom:20px;padding-left:20px;padding-right:20px;">
      <table width="1100" align="center" border="0" cellspacing="0" cellpadding="0">
        <tr>
          <td align="center" valign="top" bgcolor="#FFFFFF">
            <table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" style="boarder-collapse;">
              <tr>
                <td valign="middle"></td>
              </tr>
              <tr>
              </tr>
              <tr>
                <td>
                  <hr/>
                </td>
              </tr>
							#if (${ctx.cmsSlotContents.TopContent})
                <tr>
                  <td align="center" valign="middle">
                    <a href="${ctx.baseUrl}" style="display:block; margin-top:10px;margin-bottom:10px;font-family:arial,helvetica,sans-serif; font-size: 12px;color:#19212b;text-decoration: none;">${ctx.cmsSlotContents.TopContent}</a>
                  </td>
                </tr>
							#end
              <tr>
                <td align="left" valign="top">

                  <p style="margin:2px 0"><font color="#000000" size="2" face="Arial, Helvetica, sans-serif"><b>${ctx.messages.getMessage('salutation', ${ctx.title}, ${ctx.displayName})}</b>,</font></p>
                  <br />

                  <p style="margin:2px 0"><font color="#000000" size="2" face="Arial, Helvetica, sans-serif">${ctx.messages.getMessage('thankYouParagraph')}</font></p>
                  <br />

                  <p style="margin:2px 0"><font color="#000000" size="2" face="Arial, Helvetica, sans-serif">${ctx.messages.getMessage('summaryBelowParagraph', "#genHtmlLinkStartTag($orderInfoUrl)", "#genHtmlBoldFont(${ctx.messages.hereLink})", "#genHtmlLinkEndTag()")}</font></p>
                <br/>
                </td>
              </tr>
              <br/>
              <br/>

              <table align="center" border="1" width="100%" cellspacing="0" cellpadding="15"> 
              <tr>
               <th>Order Number</th>
               <th>Brand</th>
               <th>PO Number</th>
               <th>Order Status</th>
               <th>Date Placed</th>
               <th>RDD</th>
               <th>Total Qty</th>
               <th>Total Tax</th>
               <th>Order Total</th>
             </tr>
				#foreach ($order in $ctx.order.subOrders)
                <tr>
                  <td align="center">
                    <div><strong>${order.code}</strong></div></td>
                    #if (!$order.orderType)
                      #set($order.orderType = "")
                    #end
                    #if (!$order.brand)
                      #set($order.brand = "")
                    #end
                   <td align="center"> 
                   <div>$order.brand
                                 </div></td>
                  <td align="center"><div>${order.purchaseOrderNumber}
                    </div></td>
                    <td align="center"><div style="display: block;font-family:arial,helvetica,sans-serif;font-size: 12px;padding-bottom:5px;">${order.status}
                </div></td>               
                <td align="center"> <div style="display: block;font-family:arial,helvetica,sans-serif;font-size: 12px;padding-bottom:5px;">${ctx.dateTool.format('d MMM, yyyy', $order.created)}
                  						</div></td>
                  <td align="center">  <div style="display: block;font-family:arial,helvetica,sans-serif;font-size: 12px;padding-bottom:5px;">${ctx.dateTool.format('d MMM, yyyy', $order.rdd)}
                  					</div></td>                 
                   <td align="center">   <div style="display: block;font-family:arial,helvetica,sans-serif;font-size: 12px;padding-bottom:5px;">${order.totalUnitCount}
                                        </div></td> 
                   <td align="center">   <div style="display: block;font-family:arial,helvetica,sans-serif;font-size: 12px;padding-bottom:5px;">${order.totalTax.formattedValue}
                                        </div></td>
                   <td align="center">   <div style="display: block;font-family:arial,helvetica,sans-serif;font-size: 12px;padding-bottom:5px;">${order.totalPrice.formattedValue}
                                        </div></td> 
                   
                </tr>
					#end
					</table>
					<br/>
		  #if ($ctx.order.subOrders.size() > 0)
		  #set ($sizeValue =0)
		 #foreach( $orderGroup in ${ctx.order.subOrders} )
		 #foreach( $entry in ${orderGroup.entries} )
		 #set ($sizeValue =1)
		 #end
		 #end
		  #end
		  #if ($ctx.order.subOrders.size() > 0 && $sizeValue > 0)
	<table width="100%" border="0" align="center" cellpadding="2" cellspacing="2" bordercolor="#51585c" class="products" style="solid #51585c;">
		<tr>
				<td>
				
				#foreach( $orderGroup in ${ctx.order.subOrders} )
					<table width="100%" cellpadding="0" cellspacing="0">
					<br/>
					<tr>
							<td width="100%" colspan="5" height="30" align="left" ><font  size="2">Order&nbsp;$orderGroup.code</b></font></td>
						</tr>
						<br/>
						<tr width="100%" align="center" height="30" bgcolor="#000000">
							<td width="10%" align="center"><font color="#FFFFFF" style="padding-left:10px;padding-right:10px;">${ctx.messages.itemNumber}</b></font></td>
							<td width="50%" align="center"><font color="#FFFFFF" style="padding-left:10px;padding-right:10px;">${ctx.messages.item}</b></font></td>
							<td width="10%" align="center"><font color="#FFFFFF" style="padding-left:10px;padding-right:10px;">${ctx.messages.quantity}</b></font></td>
							<td width="15%" align="center"><font color="#FFFFFF" style="padding-left:10px;padding-right:10px;">${ctx.messages.itemPrice}</b></font></td>
							<td width="15%" align="center"><font color="#FFFFFF" style="padding-left:10px;padding-right:10px;">${ctx.messages.total}</b></font></td>
						</tr>
						#foreach( $entry in ${orderGroup.entries} )
						<tr>
						<td style=" border-collapse: collapse;" colspan="5">
						
						<table width="100%" cellpadding="0" cellspacing="0" style=" border-collapse: collapse; border: 1px solid #51585c;">
							<tr>
							
							 
							    <td width="10% valign="top" align="center"><p><font color="#666666" size="2" face="Arial, Helvetica, sans-serif">$velocityCount</font></p>
							     </td>
                            
							<td>
									<table width="100%" border="0" cellpadding="0" cellspacing="0">
										<tr>
											<td width="50% valign="top" align="center">
												<p><font color="#666666"  size="2" face="Arial, Helvetica, sans-serif">
													<a href="${ctx.baseUrl}$entry.product.url"><font color="#666666"><b>$entry.product.code/$entry.product.name</b></font></a>
												</p>
												#foreach( $entry1 in ${entry.entries} )
												#if (!$entry1.product.baseOptions.isEmpty())
													#foreach ($option in $entry1.product.baseOptions)
														#if (!$option.selected.isEmpty && ($option.selected.url == $entry1.product.url))
															<table width="100%" cellpadding="0" cellspacing="0">
																#foreach ($selectedOption in $option.selected.variantOptionQualifiers)
																  <td align="center" valign="top"><p><font color="#666666" size="2" face="Arial, Helvetica, sans-serif">$selectedOption.name : &nbsp; $selectedOption.value </font></p></td>
																#end
															</table>
														#end
													#end
												#end
											#end
											</td>
										</tr>
									</table>
								</td>
								
								<td valign="top" width="10%" align="center"><p><font color="#666666" size="2" face="Arial, Helvetica, sans-serif">$entry.quantity</font></p>
								</td>
								<td valign="top" width="15%" align="center"><p><font color="#666666" size="2" face="Arial, Helvetica, sans-serif">$entry.erpPrice.formattedValue</font></p>
								</td>
								#set ($total = $entry.erpPrice.value * $entry.quantity)
								<td valign="top" width="15%" align="center"><p><font color="#414a4f" size="2" face="Arial, Helvetica, sans-serif">£$total</font></p>
								</td>
							</tr>
							
	                       </table>
	                       </td>
	                       </tr>
						#end
					</table>
					</br>
				#end
			</td>
		</tr>
	</table>
	
	#else
	
	<table width="90%" border="0" align="center" cellpadding="2" cellspacing="2" bordercolor="#51585c" class="products" style="solid #51585c;">
		<tr>
				<td>
				
				#foreach( $orderGroup in ${ctx.order.deliveryOrderGroups} )
					<table width="100%" cellpadding="0" cellspacing="0">
					<br/>
					<tr>
							<td width="100%" colspan="4" height="30" align="left" ><font  size="4" style="padding-left:5px">${ctx.messages.yourDeliveryItems}&nbsp;${ctx.order.code}</b></font></td>
						</tr>
						<br/>
						<tr width="100%" height="30" bgcolor="#000000">
							<td width="20%"><font color="#FFFFFF" style="padding-left:10px;padding-right:10px;">${ctx.messages.itemNumber}</b></font></td>
							<td width="40%"><font color="#FFFFFF" style="padding-left:10px;padding-right:10px;">${ctx.messages.item}</b></font></td>
							<td width="20%"><font color="#FFFFFF" style="padding-left:10px;padding-right:10px;">${ctx.messages.quantity}</b></font></td>
							<td width="17%"><font color="#FFFFFF" style="padding-left:10px;padding-right:10px;">${ctx.messages.itemPrice}</b></font></td>
							<td width="30%"><font color="#FFFFFF" style="padding-left:10px;padding-right:10px;">${ctx.messages.total}</b></font></td>
						</tr>
						#foreach( $entry in ${orderGroup.entries} )
						<tr>
						<td style=" border-collapse: collapse;" colspan="5">
						
						<table width="100%" cellpadding="0" cellspacing="0" style=" border-collapse: collapse; border: 1px solid #51585c;">
							<tr>
							
							 
							    <td valign="top" ><p><font color="#666666" size="2" face="Arial, Helvetica, sans-serif" style="padding-left:20px;">$velocityCount</font></p>
							     </td>
                            
							<td>
									<table width="100%" border="0" cellpadding="0" cellspacing="0">
										<tr>
											<td width="40% valign="top" style="padding-left:10px;padding-right:10px;">
												<p><font color="#666666"  size="2" face="Arial, Helvetica, sans-serif">
													<a href="${ctx.baseUrl}$entry.product.url"><font color="#666666"><b>$entry.product.code/$entry.product.name;</b></font></a>
												</p>
												
												#if (!$entry.product.baseOptions.isEmpty())
													#foreach ($option in $entry.product.baseOptions)
														#if (!$option.selected.isEmpty && ($option.selected.url == $entry.product.url))
															<table width="100%" cellpadding="0" cellspacing="0">
																#foreach ($selectedOption in $option.selected.variantOptionQualifiers)
																  <td style="padding-left:5px;padding-right:5px;" valign="top"><p><font color="#666666" size="2" face="Arial, Helvetica, sans-serif">$selectedOption.name : &nbsp; $selectedOption.value </font></p></td>
																#end
															</table>
														#end
													#end
												#end
											
											</td>
										</tr>
									</table>
								</td>
								
								<td valign="top" width="20%"><p><font color="#666666" size="2" face="Arial, Helvetica, sans-serif">$entry.quantity</font></p>
								</td>
								<td valign="top" width="12%"><p><font color="#666666" size="2" face="Arial, Helvetica, sans-serif">$entry.erpPrice.formattedValue</font></p>
								</td>
								#set ($total = $entry.erpPrice.value * $entry.quantity)
								<td valign="top" width="8%"><p><font color="#414a4f" size="2" face="Arial, Helvetica, sans-serif"><b>£$total</b></font></p>
								</td>
							</tr>
							
	                       </table>
	                       </td>
	                       </tr>
						#end
					</table>
					</br>
				#end
			</td>
		</tr>
	</table>
	
	#end 
	
					
			<br/>
			<br/>		
							
              <tr>
                <td>
                  #set ($contactLink = $ctx.secureBaseUrl + $ctx.messages.contactUsPage)
                  <p style="margin:2px 0"><font color="#000000" size="2" face="Arial, Helvetica, sans-serif">${ctx.messages.getMessage('contactUsParagraph', "#genHtmlLinkStartTag($contactLink)", "#genHtmlBoldFont(${ctx.messages.contactUs})", "#genHtmlLinkEndTag()")}</font></p>
                  <p>
                    <font color="#000000" size="2" face="Arial, Helvetica, sans-serif">
											${ctx.messages.complimentaryClosing}
                      <br />
											${ctx.messages.companyName}
                    </font>
                  </p>
                  <br />
                </td>
              </tr>
							#if (${ctx.cmsSlotContents.BottomContent})
                <tr>
                  <td align="center" valign="middle">
                    <a href="${ctx.baseUrl}" style="display:block; margin-top:10px;margin-bottom:10px;">${ctx.cmsSlotContents.BottomContent}</a>
                  </td>
                </tr>
              #else
                <hr/>
							#end
              <tr>
								#if ($ctx.salesRep)
                  <td>
                    <div style="display: block;font-family:arial,helvetica,sans-serif;font-size: 12px;padding-bottom:5px;"><strong>$ctx.messages.internalUse</strong></div>
                    <div style="display: block;font-family:arial,helvetica,sans-serif;font-size: 12px;padding-bottom:5px;">$ctx.messages.getMessage('internalCustomerName',$ctx.customer.name)</div>
                    <div style="display: block;font-family:arial,helvetica,sans-serif;font-size: 12px;padding-bottom:5px;">$ctx.messages.getMessage('internalCustomerEmail',$ctx.customer.uid)</div>
                    <div style="display: block;font-family:arial,helvetica,sans-serif;font-size: 12px;padding-bottom:5px;">$ctx.messages.getMessage('internalCustomerSoldTo',$ctx.account)</div>
                  </td>
								#end
              </tr>
            </table>
          </td>
        </tr>
      </table>
    </td>
  </tr>
  <tr>
    <td bgcolor="#F4F4F4" style="padding-top:26px;padding-bottom:50px;padding-right:35px;padding-left:40px;">
      <table style="width: 100%; height: 30px; border-collapse:collapse;" cellpadding="0">
        <tbody>
        <tr>
          <td align="center" style="font-size: 12px;">
						${ctx.messages.companyFullName}
            <br/> ${ctx.messages.companyAddress}
            <br/> ${ctx.secureBaseUrl}
          </td>
        </tr>
        </tbody>
      </table>
    </td>
  </tr>
  <tr>
    <td> </td>
  </tr>
</table>
</body>

</html>